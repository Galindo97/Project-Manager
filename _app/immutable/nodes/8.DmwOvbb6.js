import{c as U,a as v,d as Mt,f as m,s as $}from"../chunks/BPUFb_mI.js";import{f as O,p as Ot,M as C,a5 as ya,u as xa,I as e,N as c,w as i,g as Lt,ah as $e,i as t,r as a,x as M,v as w,aj as ka}from"../chunks/Cxs6_Da5.js";import{i as b}from"../chunks/Bv05hcF2.js";import{I as W,s as Y,g as wa,r as ye,e as Se,d as We,i as It,h as za}from"../chunks/D34v4-Dx.js";import{B as Vt,C as Ht,a as Jt,t as de,s as ve}from"../chunks/iiDGZMtV.js";import{b as xe}from"../chunks/Cwvagt3j.js";import{l as Z,s as ee,a as jt,b as Ft}from"../chunks/CPoXIpK2.js";import{p as Gt}from"../chunks/ylPGLqSw.js";import{g as Ye}from"../chunks/DZTiMjil.js";import"../chunks/33NwUyeK.js";import{C as Ze}from"../chunks/D8tM2hHp.js";import{X as ke}from"../chunks/C3s6pWLt.js";import{a as ea,P as Bt}from"../chunks/BEGN4lTp.js";import{P as Te}from"../chunks/CcVjobh8.js";import{T as aa}from"../chunks/Cm-ZPPP-.js";function Pa(S,h){const T=Z(h,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"m12 19-7-7 7-7"}],["path",{d:"M19 12H5"}]];W(S,ee({name:"arrow-left"},()=>T,{get iconNode(){return A},children:(D,I)=>{var l=U(),z=O(l);Y(z,h,"default",{}),v(D,l)},$$slots:{default:!0}}))}function Na(S,h){const T=Z(h,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]];W(S,ee({name:"file-text"},()=>T,{get iconNode(){return A},children:(D,I)=>{var l=U(),z=O(l);Y(z,h,"default",{}),v(D,l)},$$slots:{default:!0}}))}function Ca(S,h){const T=Z(h,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5"}]];W(S,ee({name:"file"},()=>T,{get iconNode(){return A},children:(D,I)=>{var l=U(),z=O(l);Y(z,h,"default",{}),v(D,l)},$$slots:{default:!0}}))}function Ut(S,h){const T=Z(h,["children","$$slots","$$events","$$legacy"]);const A=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]];W(S,ee({name:"image"},()=>T,{get iconNode(){return A},children:(D,I)=>{var l=U(),z=O(l);Y(z,h,"default",{}),v(D,l)},$$slots:{default:!0}}))}function ta(S,h){const T=Z(h,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]];W(S,ee({name:"save"},()=>T,{get iconNode(){return A},children:(D,I)=>{var l=U(),z=O(l);Y(z,h,"default",{}),v(D,l)},$$slots:{default:!0}}))}function Rt(S,h){const T=Z(h,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"}],["path",{d:"M12 9v4"}],["path",{d:"M12 17h.01"}]];W(S,ee({name:"triangle-alert"},()=>T,{get iconNode(){return A},children:(D,I)=>{var l=U(),z=O(l);Y(z,h,"default",{}),v(D,l)},$$slots:{default:!0}}))}function Sa(S,h){const T=Z(h,["children","$$slots","$$events","$$legacy"]);const A=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2"}]];W(S,ee({name:"video"},()=>T,{get iconNode(){return A},children:(D,I)=>{var l=U(),z=O(l);Y(z,h,"default",{}),v(D,l)},$$slots:{default:!0}}))}var Xt=m('<div class="loading svelte-d6agom"><div class="spinner svelte-d6agom"></div> <p>Cargando tarea...</p></div>'),qt=m('<div class="error svelte-d6agom"><p>No se encontró la tarea</p> <button class="back-btn-error svelte-d6agom"><!> Volver al listado</button></div>'),Kt=m('<div class="completed-banner svelte-d6agom"><!> <span class="svelte-d6agom">Tarea Completada - Modo Solo Lectura</span> <button class="back-to-completed svelte-d6agom">Ver todas las completadas</button></div>'),Qt=m('<div class="edit-title-container svelte-d6agom"><input type="text" class="title-input svelte-d6agom"/> <button class="save-btn svelte-d6agom" title="Guardar"><!></button> <button class="cancel-btn svelte-d6agom" title="Cancelar"><!></button></div>'),Wt=m('<button class="edit-icon-btn svelte-d6agom" title="Editar título"><!></button>'),Yt=m('<h1 class="task-title svelte-d6agom"> <!></h1>'),Zt=m('<span class="badge deadline svelte-d6agom"><!> </span>'),es=m('<div class="progress-edit svelte-d6agom"><input type="range" min="0" max="100" class="progress-slider svelte-d6agom"/> <span class="progress-value svelte-d6agom"> </span> <button class="save-btn-small svelte-d6agom"><!></button> <button class="cancel-btn-small svelte-d6agom"><!></button></div>'),as=m('<button class="edit-icon-btn-small svelte-d6agom"><!></button>'),ts=m('<div class="progress-display svelte-d6agom"><span class="progress-value svelte-d6agom"> </span> <!></div>'),ss=m('<button class="edit-btn-header svelte-d6agom"><!></button>'),rs=m('<div class="edit-area"><textarea placeholder="Añade una descripción detallada..." class="textarea svelte-d6agom" rows="6"></textarea> <div class="button-group"><button class="btn btn-primary svelte-d6agom"><!> Guardar</button> <button class="btn btn-secondary svelte-d6agom"><!> Cancelar</button></div></div>'),os=m('<p class="description-text svelte-d6agom"> </p>'),is=m('<p class="empty-state svelte-d6agom"> </p>'),ns=m('<div class="card-content svelte-d6agom"><!></div>'),ls=m('<div class="file-preview image-preview svelte-d6agom"><img class="svelte-d6agom"/></div> <div class="file-info svelte-d6agom"><!> <span class="file-name svelte-d6agom"> </span></div>',1),ds=m('<div class="file-preview video-preview svelte-d6agom"><!></div> <div class="file-info svelte-d6agom"><!> <span class="file-name svelte-d6agom"> </span></div>',1),vs=m('<div class="file-preview file-icon-preview svelte-d6agom"><!></div> <div class="file-info svelte-d6agom"><!> <span class="file-name svelte-d6agom"> </span></div>',1),cs=m('<a target="_blank" rel="noopener" class="file-item svelte-d6agom"><!></a>'),_s=m('<section class="card files-card svelte-d6agom"><div class="card-header svelte-d6agom"><h2 class="svelte-d6agom"><!> </h2></div> <div class="card-content svelte-d6agom"><div class="files-grid svelte-d6agom"></div></div></section>'),gs=m('<button class="add-btn svelte-d6agom"><!> Añadir</button>'),ps=m('<div class="add-note-form"><textarea placeholder="Escribe tu nota..." class="textarea svelte-d6agom" rows="3"></textarea> <div class="button-group"><button class="btn btn-primary svelte-d6agom"><!> Añadir</button> <button class="btn btn-secondary svelte-d6agom"><!> Cancelar</button></div></div>'),ms=m('<p class="empty-state svelte-d6agom"> </p>'),us=m('<button class="delete-note-btn svelte-d6agom" title="Eliminar nota"><!></button>'),fs=m('<div class="note-item svelte-d6agom"><div class="note-content svelte-d6agom"><p class="note-text svelte-d6agom"> </p> <span class="note-date svelte-d6agom"> </span></div> <!></div>'),bs=m('<div class="notes-list svelte-d6agom"></div>'),hs=m('<button class="add-btn svelte-d6agom"><!> Añadir</button>'),$s=m('<div class="add-critical-form svelte-d6agom"><input type="text" placeholder="Describe el punto crítico..." class="input svelte-d6agom"/> <div class="button-group"><button class="btn btn-primary svelte-d6agom"><!> Añadir</button> <button class="btn btn-secondary svelte-d6agom"><!> Cancelar</button></div></div>'),ys=m('<p class="empty-state svelte-d6agom"> </p>'),xs=m('<button class="delete-critical-btn svelte-d6agom" title="Eliminar"><!></button>'),ks=m('<div class="critical-item svelte-d6agom"><label class="checkbox-container svelte-d6agom"><input type="checkbox" class="svelte-d6agom"/> <span class="checkmark svelte-d6agom"></span></label> <span class="critical-text svelte-d6agom"> </span> <!></div>'),ws=m('<div class="critical-list svelte-d6agom"></div>'),zs=m('<button class="delete-critical-btn svelte-d6agom" title="Eliminar"><!></button>'),Ps=m('<div class="critical-item resolved svelte-d6agom"><label class="checkbox-container svelte-d6agom"><input type="checkbox" class="svelte-d6agom"/> <span class="checkmark svelte-d6agom"></span></label> <span class="critical-text svelte-d6agom"> </span> <!></div>'),Ns=m('<section class="card critical-card completed-critical-card svelte-d6agom"><div class="card-header svelte-d6agom"><h2 class="svelte-d6agom"><!> </h2></div> <div class="card-content svelte-d6agom"><div class="critical-list svelte-d6agom"></div></div></section>'),Cs=m('<div class="header svelte-d6agom"><button class="back-btn svelte-d6agom"><!></button> <!> <div class="title-section svelte-d6agom"><!> <div class="meta-info svelte-d6agom"><span class="badge priority svelte-d6agom"> </span> <span class="badge category svelte-d6agom"> </span> <!></div></div></div> <div class="progress-section svelte-d6agom"><div class="progress-header svelte-d6agom"><span class="progress-label svelte-d6agom"><!> Progreso</span> <!></div> <div class="progress-bar svelte-d6agom"><div class="progress-fill svelte-d6agom"></div></div></div> <div class="content-grid svelte-d6agom"><section class="card description-card svelte-d6agom"><div class="card-header svelte-d6agom"><h2 class="svelte-d6agom"><!> Descripción</h2> <!></div> <!></section> <!> <section class="card notes-card svelte-d6agom"><div class="card-header svelte-d6agom"><h2 class="svelte-d6agom"><!> </h2> <!></div> <div class="card-content svelte-d6agom"><!> <!></div></section> <section class="card critical-card svelte-d6agom"><div class="card-header svelte-d6agom"><h2 class="svelte-d6agom"><!> </h2> <!></div> <div class="card-content svelte-d6agom"><!> <!> <!></div></section> <!></div>',1),Ss=m('<div class="task-detail-container svelte-d6agom" role="application"><div class="main-container svelte-d6agom"><!></div> <button class="floating-ai-btn svelte-d6agom" aria-label="Abrir AI Assistant"><!></button> <!></div>');function Us(S,h){Ot(h,!0);const T=()=>jt(Gt,"$page",A),[A,D]=Ft(),I="http://localhost:8000";let l=C(null),z=C(!0),Ae=C(""),ce=C(!1),we=C(!1),_e=C(""),ge=C(""),V=C(ya([])),ae=C(""),te=C(!1),y=C(ya([])),se=C(""),re=C(!1),pe=$e(()=>e(y).filter(n=>!n.resolved)),ze=$e(()=>e(y).filter(n=>n.resolved));xa(()=>{console.log("Estado de puntos críticos:"),console.log("- Total:",e(y).length),console.log("- Pendientes:",e(pe).length),console.log("- Completados:",e(ze).length),console.log("- Lista completa:",e(y))});let k=$e(()=>e(l)?.completed??!1),Pe=C(!1),me=C(0),De=C(!1);xa(()=>{const n=T().params.id;n&&(c(Ae,n,!0),sa())});async function sa(){try{const n=await fetch(`${I}/tasks/${e(Ae)}`);if(!n.ok)throw new Error("Tarea no encontrada");const u=await n.json();if(c(l,u,!0),u.notes)try{c(V,JSON.parse(u.notes),!0)}catch{c(V,[],!0)}if(u.critical_points)try{c(y,JSON.parse(u.critical_points),!0),console.log("Puntos críticos cargados:",e(y))}catch{c(y,[],!0)}else c(y,[],!0);c(z,!1)}catch(n){console.error("Error fetching task:",n),c(z,!1)}}async function R(n){if(!e(l))return;const u=new FormData;u.append("title",n.title??e(l).title),u.append("priority",n.priority??e(l).priority),u.append("completed",String(n.completed??e(l).completed)),u.append("category",n.category??e(l).category??"General"),e(l).deadline&&u.append("deadline",e(l).deadline),n.description!==void 0&&u.append("description",n.description),n.notes!==void 0&&u.append("notes",n.notes),n.progress!==void 0&&u.append("progress",String(n.progress)),n.critical_points!==void 0&&u.append("critical_points",n.critical_points);try{(await fetch(`${I}/tasks/${e(Ae)}`,{method:"PUT",body:u})).ok&&await sa()}catch(H){console.error("Error updating task:",H)}}function Ta(){c(ce,!0),c(_e,e(l)?.description||"",!0)}function Aa(){c(ce,!1),c(_e,"")}async function Da(){await R({description:e(_e)}),c(ce,!1)}function Ea(){c(we,!0),c(ge,e(l)?.title||"",!0)}async function Ma(){await R({title:e(ge)}),c(we,!1)}function Oa(){c(we,!1),c(ge,"")}function La(){c(Pe,!0),c(me,e(l)?.progress||0,!0)}async function Ia(){await R({progress:e(me)}),c(Pe,!1)}function Va(){c(Pe,!1)}async function Ha(){if(!e(ae).trim())return;const n={id:Date.now().toString(),text:e(ae),timestamp:new Date().toISOString()};c(V,[...e(V),n],!0),await R({notes:JSON.stringify(e(V))}),c(ae,""),c(te,!1)}async function Ja(n){c(V,e(V).filter(u=>u.id!==n),!0),await R({notes:JSON.stringify(e(V))})}async function ja(){if(!e(se).trim())return;const n={id:Date.now().toString(),text:e(se),resolved:!1};c(y,[...e(y),n],!0),console.log("Añadiendo punto crítico:",n),console.log("Lista completa:",e(y)),await R({critical_points:JSON.stringify(e(y))}),c(se,""),c(re,!1)}async function ra(n){console.log("Toggle punto crítico:",n);const u=[...e(y)];c(y,e(y).map(H=>H.id===n?{...H,resolved:!H.resolved}:H),!0),console.log("Antes:",u),console.log("Después:",e(y)),await R({critical_points:JSON.stringify(e(y))})}async function oa(n){c(y,e(y).filter(u=>u.id!==n),!0),await R({critical_points:JSON.stringify(e(y))})}function Fa(n){if(!n)return"Sin fecha límite";const[u,H,Oe]=n.split("-").map(Number);return new Date(u,H-1,Oe).toLocaleDateString("es-ES",{day:"numeric",month:"long",year:"numeric"})}function Ga(n){return new Date(n).toLocaleString("es-ES",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}function Ba(n){const u=n.split(".").pop()?.toLowerCase();return["jpg","jpeg","png","gif","webp","svg"].includes(u||"")?"image":["mp4","webm","ogg","mov"].includes(u||"")?"video":"file"}function Ua(n){switch(n){case"high":return"#ff7b54";case"medium":return"#f6e05e";case"low":return"#63b3ed";default:return"#7d8da6"}}function Ra(n){switch(n){case"high":return"Alta";case"medium":return"Media";case"low":return"Baja";default:return n}}var Ee=Ss(),Me=t(Ee),Xa=t(Me);{var qa=n=>{var u=Xt();v(n,u)},Ka=n=>{var u=U(),H=O(u);{var Oe=oe=>{var ie=qt(),K=i(t(ie),2);K.__click=()=>Ye("/tasklist");var ne=t(K);Pa(ne,{size:20}),M(),a(K),a(ie),v(oe,ie)},ia=oe=>{var ie=Cs(),K=O(ie),ne=t(K);ne.__click=()=>Ye("/tasklist");var Ya=t(ne);Pa(Ya,{size:20}),a(ne);var na=i(ne,2);{var Za=r=>{var s=Kt(),o=t(s);Ze(o,{size:20});var g=i(o,4);g.__click=()=>Ye("/completed"),a(s),v(r,s)};b(na,r=>{e(k)&&r(Za)})}var la=i(na,2),da=t(la);{var et=r=>{var s=Qt(),o=t(s);ye(o);var g=i(o,2);g.__click=Ma;var _=t(g);ta(_,{size:18}),a(g);var p=i(g,2);p.__click=Oa;var d=t(p);ke(d,{size:18}),a(p),a(s),xe(o,()=>e(ge),f=>c(ge,f)),v(r,s)},at=r=>{var s=Yt(),o=t(s),g=i(o);{var _=p=>{var d=Wt();d.__click=Ea;var f=t(d);ea(f,{size:18}),a(d),v(p,d)};b(g,p=>{e(k)||p(_)})}a(s),w(()=>$(o,`${e(l).title??""} `)),v(r,s)};b(da,r=>{e(we)&&!e(k)?r(et):r(at,!1)})}var va=i(da,2),Ce=t(va),tt=t(Ce,!0);a(Ce);var Le=i(Ce,2),st=t(Le,!0);a(Le);var rt=i(Le,2);{var ot=r=>{var s=Zt(),o=t(s);Jt(o,{size:14});var g=i(o);a(s),w(_=>$(g,` ${_??""}`),[()=>Fa(e(l).deadline)]),v(r,s)};b(rt,r=>{e(l).deadline&&r(ot)})}a(va),a(la),a(K);var Ie=i(K,2),Ve=t(Ie),He=t(Ve),it=t(He);Ze(it,{size:18}),M(),a(He);var nt=i(He,2);{var lt=r=>{var s=es(),o=t(s);ye(o);var g=i(o,2),_=t(g);a(g);var p=i(g,2);p.__click=Ia;var d=t(p);ta(d,{size:14}),a(p);var f=i(p,2);f.__click=Va;var x=t(f);ke(x,{size:14}),a(f),a(s),w(()=>$(_,`${e(me)??""}%`)),xe(o,()=>e(me),P=>c(me,P)),v(r,s)},dt=r=>{var s=ts(),o=t(s),g=t(o);a(o);var _=i(o,2);{var p=d=>{var f=as();f.__click=La;var x=t(f);ea(x,{size:14}),a(f),v(d,f)};b(_,d=>{e(k)||d(p)})}a(s),w(()=>$(g,`${(e(l).progress||0)??""}%`)),v(r,s)};b(nt,r=>{e(Pe)&&!e(k)?r(lt):r(dt,!1)})}a(Ve);var ca=i(Ve,2),vt=t(ca);a(ca),a(Ie);var _a=i(Ie,2),Je=t(_a),je=t(Je),Fe=t(je),ct=t(Fe);Na(ct,{size:20}),M(),a(Fe);var _t=i(Fe,2);{var gt=r=>{var s=ss();s.__click=Ta;var o=t(s);ea(o,{size:16}),a(s),v(r,s)};b(_t,r=>{!e(ce)&&!e(k)&&r(gt)})}a(je);var pt=i(je,2);{var mt=r=>{var s=rs(),o=t(s);ka(o);var g=i(o,2),_=t(g);_.__click=Da;var p=t(_);ta(p,{size:16}),M(),a(_);var d=i(_,2);d.__click=Aa;var f=t(d);ke(f,{size:16}),M(),a(d),a(g),a(s),xe(o,()=>e(_e),x=>c(_e,x)),de(3,s,()=>ve),v(r,s)},ut=r=>{var s=ns(),o=t(s);{var g=p=>{var d=os(),f=t(d,!0);a(d),w(()=>$(f,e(l).description)),v(p,d)},_=p=>{var d=is(),f=t(d,!0);a(d),w(()=>$(f,e(k)?"Sin descripción.":"Sin descripción. Haz clic en editar para añadir una.")),v(p,d)};b(o,p=>{e(l).description?p(g):p(_,!1)})}a(s),v(r,s)};b(pt,r=>{e(ce)&&!e(k)?r(mt):r(ut,!1)})}a(Je);var ga=i(Je,2);{var ft=r=>{var s=_s(),o=t(s),g=t(o),_=t(g);Bt(_,{size:20});var p=i(_);a(g),a(o);var d=i(o,2),f=t(d);Se(f,21,()=>e(l).files,It,(x,P)=>{const J=$e(()=>Ba(e(P)));var E=cs(),N=t(E);{var L=X=>{var Q=ls(),j=O(Q),F=t(j);a(j);var le=i(j,2),G=t(le);Ut(G,{size:16});var q=i(G,2),B=t(q,!0);a(q),a(le),w(()=>{We(F,"src",`${I}/static/${e(P)}`),We(F,"alt",e(P)),$(B,e(P))}),v(X,Q)},ue=X=>{var Q=U(),j=O(Q);{var F=G=>{var q=ds(),B=O(q),Ke=t(B);Sa(Ke,{size:32}),a(B);var fe=i(B,2),be=t(fe);Sa(be,{size:16});var he=i(be,2),Qe=t(he,!0);a(he),a(fe),w(()=>$(Qe,e(P))),v(G,q)},le=G=>{var q=vs(),B=O(q),Ke=t(B);Ca(Ke,{size:32}),a(B);var fe=i(B,2),be=t(fe);Ca(be,{size:16});var he=i(be,2),Qe=t(he,!0);a(he),a(fe),w(()=>$(Qe,e(P))),v(G,q)};b(j,G=>{e(J)==="video"?G(F):G(le,!1)},!0)}v(X,Q)};b(N,X=>{e(J)==="image"?X(L):X(ue,!1)})}a(E),w(()=>We(E,"href",`${I}/static/${e(P)}`)),v(x,E)}),a(f),a(d),a(s),w(()=>$(p,` Archivos (${e(l).files.length??""})`)),v(r,s)};b(ga,r=>{e(l).files&&e(l).files.length>0&&r(ft)})}var Ge=i(ga,2),Be=t(Ge),Ue=t(Be),pa=t(Ue);Na(pa,{size:20});var bt=i(pa);a(Ue);var ht=i(Ue,2);{var $t=r=>{var s=gs();s.__click=()=>c(te,!0);var o=t(s);Te(o,{size:16}),M(),a(s),v(r,s)};b(ht,r=>{!e(te)&&!e(k)&&r($t)})}a(Be);var ma=i(Be,2),ua=t(ma);{var yt=r=>{var s=ps(),o=t(s);ka(o);var g=i(o,2),_=t(g);_.__click=Ha;var p=t(_);Te(p,{size:16}),M(),a(_);var d=i(_,2);d.__click=()=>{c(te,!1),c(ae,"")};var f=t(d);ke(f,{size:16}),M(),a(d),a(g),a(s),xe(o,()=>e(ae),x=>c(ae,x)),de(3,s,()=>ve),v(r,s)};b(ua,r=>{e(te)&&!e(k)&&r(yt)})}var xt=i(ua,2);{var kt=r=>{var s=ms(),o=t(s,!0);a(s),w(()=>$(o,e(k)?"No hay notas.":"No hay notas todavía. Añade la primera!")),v(r,s)},wt=r=>{var s=bs();Se(s,21,()=>e(V),o=>o.id,(o,g)=>{var _=fs(),p=t(_),d=t(p),f=t(d,!0);a(d);var x=i(d,2),P=t(x,!0);a(x),a(p);var J=i(p,2);{var E=N=>{var L=us();L.__click=()=>Ja(e(g).id);var ue=t(L);aa(ue,{size:14}),a(L),v(N,L)};b(J,N=>{e(k)||N(E)})}a(_),w(N=>{$(f,e(g).text),$(P,N)},[()=>Ga(e(g).timestamp)]),de(3,_,()=>ve),v(o,_)}),a(s),v(r,s)};b(xt,r=>{e(V).length===0&&!e(te)?r(kt):r(wt,!1)})}a(ma),a(Ge);var Re=i(Ge,2),Xe=t(Re),qe=t(Xe),fa=t(qe);Rt(fa,{size:20});var zt=i(fa);a(qe);var Pt=i(qe,2);{var Nt=r=>{var s=hs();s.__click=()=>c(re,!0);var o=t(s);Te(o,{size:16}),M(),a(s),v(r,s)};b(Pt,r=>{!e(re)&&!e(k)&&r(Nt)})}a(Xe);var ba=i(Xe,2),ha=t(ba);{var Ct=r=>{var s=$s(),o=t(s);ye(o);var g=i(o,2),_=t(g);_.__click=ja;var p=t(_);Te(p,{size:16}),M(),a(_);var d=i(_,2);d.__click=()=>{c(re,!1),c(se,"")};var f=t(d);ke(f,{size:16}),M(),a(d),a(g),a(s),xe(o,()=>e(se),x=>c(se,x)),de(3,s,()=>ve),v(r,s)};b(ha,r=>{e(re)&&!e(k)&&r(Ct)})}var $a=i(ha,2);{var St=r=>{var s=ys(),o=t(s,!0);a(s),w(()=>$(o,e(k)?"No hay puntos críticos pendientes.":"No hay puntos críticos pendientes. ¡Excelente trabajo!")),v(r,s)};b($a,r=>{e(pe).length===0&&!e(re)&&r(St)})}var Tt=i($a,2);{var At=r=>{var s=ws();Se(s,21,()=>e(pe),o=>o.id,(o,g)=>{var _=ks(),p=t(_),d=t(p);ye(d),za(d,!1),d.__change=()=>ra(e(g).id),M(2),a(p);var f=i(p,2),x=t(f,!0);a(f);var P=i(f,2);{var J=E=>{var N=xs();N.__click=()=>oa(e(g).id);var L=t(N);aa(L,{size:14}),a(N),v(E,N)};b(P,E=>{e(k)||E(J)})}a(_),w(()=>{d.disabled=e(k),$(x,e(g).text)}),de(3,_,()=>ve),v(o,_)}),a(s),v(r,s)};b(Tt,r=>{e(pe).length>0&&r(At)})}a(ba),a(Re);var Dt=i(Re,2);{var Et=r=>{var s=Ns(),o=t(s),g=t(o),_=t(g);Ze(_,{size:20});var p=i(_);a(g),a(o);var d=i(o,2),f=t(d);Se(f,21,()=>e(ze),x=>x.id,(x,P)=>{var J=Ps(),E=t(J),N=t(E);ye(N),za(N,!0),N.__change=()=>ra(e(P).id),M(2),a(E);var L=i(E,2),ue=t(L,!0);a(L);var X=i(L,2);{var Q=j=>{var F=zs();F.__click=()=>oa(e(P).id);var le=t(F);aa(le,{size:14}),a(F),v(j,F)};b(X,j=>{e(k)||j(Q)})}a(J),w(()=>{N.disabled=e(k),$(ue,e(P).text)}),de(3,J,()=>ve),v(x,J)}),a(f),a(d),a(s),w(()=>$(p,` Puntos Críticos Completados (${e(ze).length??""})`)),v(r,s)};b(Dt,r=>{e(ze).length>0&&r(Et)})}a(_a),w((r,s)=>{wa(Ce,`background: ${r??""}`),$(tt,s),$(st,e(l).category||"General"),wa(vt,`width: ${(e(l).progress||0)??""}%`),$(bt,` Notas (${e(V).length??""})`),$(zt,` Puntos Críticos Pendientes (${e(pe).length??""})`)},[()=>Ua(e(l).priority),()=>Ra(e(l).priority)]),v(oe,ie)};b(H,oe=>{e(l)?oe(ia,!1):oe(Oe)},!0)}v(n,u)};b(Xa,n=>{e(z)?n(qa):n(Ka,!1)})}a(Me);var Ne=i(Me,2);Ne.__click=()=>c(De,!0);var Qa=t(Ne);Vt(Qa,{size:24}),a(Ne);var Wa=i(Ne,2);{let n=$e(()=>e(l)?.id);Ht(Wa,{get taskId(){return e(n)},get isOpen(){return e(De)},set isOpen(u){c(De,u,!0)}})}a(Ee),v(S,Ee),Lt(),D()}Mt(["click","change"]);export{Us as component};
